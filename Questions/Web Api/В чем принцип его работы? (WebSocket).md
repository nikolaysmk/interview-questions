Принцип работы WebSocket заключается в установлении постоянного соединения между клиентом (браузером) и сервером, позволяющего обмениваться сообщениями в режиме реального времени². Для этого клиент и сервер используют специальный протокол рукопожатия поверх HTTP(S), который позволяет перейти на WebSocket¹.

Процесс рукопожатия выглядит следующим образом:

- Клиент отправляет HTTP-запрос с заголовками Upgrade и Connection, указывающими, что он хочет перейти на WebSocket. Также он отправляет заголовки Sec-WebSocket-Key и Sec-WebSocket-Version, содержащие случайную строку и версию протокола соответственно¹. Например:

```http
GET /demo HTTP/1.1
Host: example.com
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==
Sec-WebSocket-Version: 13
```

- Сервер, если он поддерживает WebSocket, отвечает с кодом 101 (Switching Protocols) и такими же заголовками Upgrade и Connection. Также он отправляет заголовок Sec-WebSocket-Accept, содержащий хеш от ключа клиента и специальной константы¹. Например:

```http
HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=
```

- После этого соединение считается установленным и готовым к обмену данными. Клиент и сервер могут отправлять друг другу сообщения в виде фреймов (фрагментов данных), которые имеют определенный формат и содержат информацию о типе, длине и содержимом данных¹. Сообщения могут быть текстовыми или бинарными².

WebSocket имеет ряд преимуществ перед HTTP:

- Двунаправленная коммуникация. Сервер может отправлять данные клиенту без запроса, что позволяет реализовать интерактивные приложения в режиме реального времени².
- Меньшая сетевая нагрузка. Соединение устанавливается один раз и держится открытым, поэтому нет накладных расходов на повторное установление соединения при каждом запросе/ответе².
- Более высокая скорость передачи данных. Клиент может получить данные сразу, как только они появились на сервере, без необходимости опрашивать сервер периодически².

